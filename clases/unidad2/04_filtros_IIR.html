
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Filtro FIR con respuesta en frecuencia arbitraria &#8212; INFO183 Análisis de sistemas lineales</title>
    
  <link rel="stylesheet" href="../../_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/ui_handle.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/translations.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">INFO183 Análisis de sistemas lineales</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Buscar este libro ..." aria-label="Buscar este libro ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  Unidad 1
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../unidad1/01_introducci%C3%B3n.html">
   1. Introducción al procesamiento digital de señales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../unidad1/02_espectro.html">
   2. Espectro y Transformada de Fourier
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../unidad1/03_muestreo.html">
   3. Efectos del muestreo y fenómeno de aliasing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../unidad1/04_enventanado.html">
   4. Fuga espectral y técnica de enventanado
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Unidad 2
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_espectrograma.html">
   1. Espectrograma
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_sistemas.html">
   2. Sistemas para el procesamiento de señales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_filtros_FIR.html">
   3. Diseño de sistemas y filtros FIR
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Navegación de palanca" aria-controls="site-navigation"
            title="Navegación de palanca" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Descarga esta pagina"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/clases/unidad2/04_filtros_IIR.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Descargar archivo fuente" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimir en PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Modo de pantalla completa"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/phuijse/UACH-INFO183/master?urlpath=tree/clases/unidad2/04_filtros_IIR.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Lanzamiento Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/phuijse/UACH-INFO183/blob/master/clases/unidad2/04_filtros_IIR.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Lanzamiento Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contenido
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Filtro FIR con respuesta en frecuencia arbitraria
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diseno-de-filtros-iir">
   Diseño de filtros IIR
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sistema-iir-infinite-impulse-response">
     Sistema IIR (infinite impulse response)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#respuesta-en-frecuencia-del-sistema-iir">
     Respuesta en frecuencia del sistema IIR
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#ejemplo">
       Ejemplo:
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diseno-de-filtros-iir-simples">
     Diseño de filtros IIR simples
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diseno-de-filtros-iir-de-segundo-orden">
     Diseño de filtros IIR de segundo orden
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diseno-de-filtros-iir-de-orden-mayor">
     Diseño de filtros IIR de orden mayor
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#respuesta-en-frecuencia-de-filtros-fir-e-iir-del-orden-equivalente">
     Respuesta en frecuencia de filtros FIR e IIR del orden equivalente
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#efectos-de-audio-a-href-https-en-wikipedia-org-wiki-wah-wah-music-wah-wah-a">
     Efectos de audio:
     <a href="https://en.wikipedia.org/wiki/Wah-wah_(music)">
      Wah-wah
     </a>
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>
<span class="kn">import</span> <span class="nn">scipy.fft</span> <span class="k">as</span> <span class="nn">sfft</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">animation</span><span class="p">,</span> <span class="n">patches</span><span class="p">,</span> <span class="n">rc</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;animation&#39;</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="s1">&#39;html5&#39;</span><span class="p">)</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;savefig&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">Audio</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="filtro-fir-con-respuesta-en-frecuencia-arbitraria">
<h1>Filtro FIR con respuesta en frecuencia arbitraria<a class="headerlink" href="#filtro-fir-con-respuesta-en-frecuencia-arbitraria" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Consideremos un filtro FIR</p>
<ul class="simple">
<li><p>De orden <span class="math notranslate nohighlight">\(L\)</span> (par) con <span class="math notranslate nohighlight">\(L+1\)</span> coeficientes</p></li>
<li><p>Centrado en el origen (cero fase)</p></li>
<li><p>Con respuesta al impulso simétrica: <span class="math notranslate nohighlight">\(h_{n} = h_{-n}\)</span></p></li>
</ul>
<p>Podemos escribir su respuesta en frecuencia como</p>
<div class="math notranslate nohighlight">
\[
H[k] = \sum_{n=-L/2}^{L/2} h[n] e^{-j \frac{2\pi}{N} k n} = h[0] + \sum_{n=1}^{L/2} h[n]\cos \left(\frac{2\pi}{N} k n\right)
\]</div>
<p>que para <span class="math notranslate nohighlight">\(k=0, \ldots, N-1\)</span> en forma matricial es</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{align} 
\begin{pmatrix} H[0] \\ H[1] \\ H[2] \\ \vdots \\ H[N-1] \\ \end{pmatrix} 
&amp;= 
\begin{pmatrix} 
1 &amp; 1 &amp; 1 &amp; \cdots &amp; 1 \\ 
1 &amp; \cos \left(\frac{2\pi}{N} \right) &amp; \cos \left(\frac{2\pi}{N} 2\right) &amp; \cdots &amp; \cos \left(\frac{2\pi}{N} L/2\right) \\ 
1 &amp; \cos \left(\frac{2\pi}{N} 2 \right) &amp; \cos \left(\frac{2\pi}{N} 4 \right) &amp; \cdots &amp; \cos \left(\frac{2\pi}{N} 2 L/2\right) \\ 
\vdots &amp; \dots &amp; \dots &amp; \ddots &amp; \vdots \\ 
1 &amp; \cos \left(\frac{2\pi}{N} (N-1)\right) &amp; \cos \left(\frac{2\pi}{N} (N-1) 2\right) &amp; \cdots &amp; \cos \left(\frac{2\pi}{N} (N-1) L/2\right) \\ 
\end{pmatrix} 
\begin{pmatrix} h[0] \\ h[1] \\ h[2] \\ \vdots \\ h[L/2] \\ \end{pmatrix} \nonumber \\
H &amp;= A h, \nonumber
\end{align} 
\end{split}\]</div>
<p>donde <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{NxL/2}\)</span></p>
<p>Si especificamos <span class="math notranslate nohighlight">\(H\)</span> podemos despejar <span class="math notranslate nohighlight">\(h\)</span> pero no podemos invertir A ya que no es cuadrada.</p>
<hr class="docutils" />
<p>Una alternativa es buscar <span class="math notranslate nohighlight">\(\hat h \approx h\)</span> que minimice el error cuadrático medio</p>
<div class="math notranslate nohighlight">
\[
\min_h \| H - Ah\|^2,
\]</div>
<p>derivando e igualando a cero obtenemos el sistema de <strong>ecuaciones normales</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{d}{dh} \| H - Ah\|^2 &amp;= 0 \nonumber \\
- 2 A^T (H - Ah) &amp;= 0 \nonumber \\
A^T A h &amp;= A^T H \nonumber \\
\hat h &amp;= (A^T A)^{-1} A^T H  \nonumber \\
\hat h &amp;= A^{\dagger} H, \nonumber
\end{align}
\end{split}\]</div>
<p>donde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(A^{\dagger} = (A^T A)^{-1} A^T\)</span> se conoce como la pseudo-inversa de A</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat h\)</span> se conoce como el <strong>estimador de mínimos cuadrados</strong> de h</p></li>
</ul>
<hr class="docutils" />
<p><code class="docutils literal notranslate"><span class="pre">scipy.signal.firls(numtaps,</span> <span class="pre">bands,</span> <span class="pre">desired,</span> <span class="pre">weight=None,</span> <span class="pre">nyq=None,</span> <span class="pre">fs=None)</span></code></p>
<ul class="simple">
<li><p>numtaps (entero impar): número de coeficientes</p></li>
<li><p>bands: secuencia creciente de frecuencias</p></li>
<li><p>desired: secuencia creciente de ganancias</p></li>
<li><p>fs (flotante): Frecuencia de muestreo</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimador de minimos cuadrados para filtro FIR usando scipy.signal</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">firls</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="mi">1000</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> 
                       <span class="n">bands</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">2340</span><span class="p">,</span> <span class="mi">2350</span><span class="p">,</span> <span class="mi">2750</span><span class="p">,</span> <span class="mi">2760</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> 
                       <span class="n">desired</span><span class="o">=</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">fs</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Respuesta al impulso&quot;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Respuesta en frecuencia&quot;</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">freq</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">sample_rate</span><span class="o">*</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">response</span><span class="p">));</span>
<span class="n">data_filt</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">freq</span><span class="p">,</span> <span class="n">ttime</span><span class="p">,</span> <span class="n">Sxx</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">(</span><span class="n">data_filt</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;tukey&#39;</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> 
                                            <span class="n">nperseg</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                            <span class="n">return_onesided</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;magnitude&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">ttime</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Sxx</span><span class="o">+</span><span class="mf">1e-4</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">magma</span><span class="p">);</span> <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1e+4</span><span class="p">]);</span>
<span class="n">Audio</span><span class="p">(</span><span class="n">data_filt</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">sample_rate</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">890099</span><span class="n">b4022d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Estimador de minimos cuadrados para filtro FIR usando scipy.signal</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">firls</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="mi">1000</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> 
<span class="ne">----&gt; </span><span class="mi">3</span>                        <span class="n">bands</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">2340</span><span class="p">,</span> <span class="mi">2350</span><span class="p">,</span> <span class="mi">2750</span><span class="p">,</span> <span class="mi">2760</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>                        <span class="n">desired</span><span class="o">=</span><span class="p">(</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">fs</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 

<span class="ne">NameError</span>: name &#39;sample_rate&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="diseno-de-filtros-iir">
<h1>Diseño de filtros IIR<a class="headerlink" href="#diseno-de-filtros-iir" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Un filtro FIR de buena calidad puede requerir una gran cantidad de coeficientes</p>
<p>Es posible implementar filtros más eficientes usando recursividad</p>
<div class="section" id="sistema-iir-infinite-impulse-response">
<h2>Sistema IIR (infinite impulse response)<a class="headerlink" href="#sistema-iir-infinite-impulse-response" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Generalizando el sistema FIR para incluir versiones pasadas de la salida y asumiendo <span class="math notranslate nohighlight">\(a[0] = 1\)</span> llegamos a</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
y[n] &amp;= b[0] x[n] + b[1] x[n-1] + b[2] x[n-2] + \ldots + b[L] x[n-L]  \nonumber \\
&amp; - a[1] y[n-1] - a[2] y[n-2] - \ldots - a[M] y[n-M] \nonumber \\
&amp;= \sum_{l=0}^{L} b[l] x[n-l] - \sum_{m=1}^{M} a[m] y[n-m]  \nonumber  \\
\sum_{m=0}^{M} a[m] y[n-m] &amp;= \sum_{l=0}^{L} b[l] x[n-l] \nonumber \\
(a * y)[n] &amp;= (b * x)[n], \nonumber
\end{align}
\end{split}\]</div>
<p>es decir dos convoluciones discretas que definen una <strong>ecuación de diferencias</strong></p>
<p>Este tipo de sistema se conoce como</p>
<ul class="simple">
<li><p>sistema IIR (infinite impulse response)</p></li>
<li><p>sistema <em>auto-regresive moving average</em> (ARMA)</p>
<ul>
<li><p>autoregresivo de orden M: incluye valores pasados de la salida</p></li>
<li><p>media movil de orden L+1: pondera el valor presente y pasados de la entrada</p></li>
</ul>
</li>
</ul>
<p>¿Cuando se recupera un sistema FIR?</p>
<p>R: Si <span class="math notranslate nohighlight">\(a[m] = 0\)</span> para <span class="math notranslate nohighlight">\(m=[1, \ldots, M]\)</span></p>
</div>
<div class="section" id="respuesta-en-frecuencia-del-sistema-iir">
<h2>Respuesta en frecuencia del sistema IIR<a class="headerlink" href="#respuesta-en-frecuencia-del-sistema-iir" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Aplicando la transformada de Fourier convertimos las convoluciones en multiplicaciones y encontramos la respuesta en frecuencia como</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\text{DFT}_N[(a * y)[n]] &amp;= \text{DFT}_N[(b * x)[n]] \nonumber \\
A[k] Y[k] &amp;= B[k] X[k] \nonumber \\
H[k] = \frac{Y[k]}{X[k]} &amp;= \frac{B[k]}{A[k]} = \frac{ \sum_{l=0}^L b[l]e^{-j \frac{2\pi}{N} nl} }{ \sum_{m=0}^M a[m]e^{-j \frac{2\pi}{N} mk}} \nonumber
\end{align}
\end{split}\]</div>
<p>siempre que <span class="math notranslate nohighlight">\(A[k] \neq 0\)</span>.</p>
<p>Se llega a un resultado equivalente usando la propiedad de traslación de la DFT</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\text{DFT}_N\left[\sum_{m=0}^{M} a[m] y[n-m]\right] &amp;= \text{DFT}_N\left[\sum_{l=0}^{L} b[l] x[n-l]\right] \nonumber \\
\sum_{m=0}^{M} a[m] \mathbb{DFT}_N\left[y[n-m]\right] &amp;= \sum_{l=0}^{L} b[l] \mathbb{DFT}_N\left[x[n-l]\right] \nonumber \\
\sum_{m=0}^{M} a[m] Y[k] e^{-j \frac{2\pi}{N} km} &amp;= \sum_{l=0}^{L} b[l] X[k] e^{-j \frac{2\pi}{N} kl} \nonumber \\
Y[k] \sum_{m=0}^{M} a[m] e^{-j \frac{2\pi}{N} km} &amp;= X[k] \sum_{l=0}^{L} b[l] e^{-j \frac{2\pi}{N} kl} \nonumber \\
H[k] = \frac{Y[k]}{X[k]} &amp;= \frac{ \sum_{l=0}^L b[l]e^{-j \frac{2\pi}{N} lk} }{ \sum_{m=0}^M a[m]e^{-j \frac{2\pi}{N} mk}} \nonumber
\end{align}
\end{split}\]</div>
<p>que también puede expresarse de forma alternativa como</p>
<div class="math notranslate nohighlight">
\[
H[k] = K \frac{ \prod_{l=1}^L (e^{j \frac{2\pi}{N} k}- \beta[l]) }{ \prod_{m=1}^M (e^{j \frac{2\pi}{N} k}- \alpha[m])} 
\]</div>
<p>donde <span class="math notranslate nohighlight">\(K\)</span> es la <strong>ganancia</strong> y las raices de los polinomios se llaman <strong>ceros</strong> (numerador) y <strong>polos</strong> (denominador)</p>
<div class="section" id="ejemplo">
<h3>Ejemplo:<a class="headerlink" href="#ejemplo" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Consideremos el siguiente sistema IIR</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
y[n] &amp;= (1-\gamma) x[n] + \gamma y[n-1] \nonumber \\
y[n] - \gamma y[n-1] &amp;= (1-\gamma) x[n] \nonumber
\end{align}
\end{split}\]</div>
<p>¿Cuántos coeficientes tiene este sistema?</p>
<p>R: <span class="math notranslate nohighlight">\(a[0] = 1\)</span>, <span class="math notranslate nohighlight">\(a[1] = -\gamma\)</span> y <span class="math notranslate nohighlight">\(b[0] = (1-\gamma)\)</span>, es decir MA de orden 1 y AR de orden 1</p>
<p>¿Cúal es su respuesta al impulso? (asumiendo <span class="math notranslate nohighlight">\(y[n]=0, n&lt;0\)</span>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
n &amp; \delta[n] &amp; y[n] \\
-2 &amp; 0 &amp; 0 \\
-1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; (1-\gamma) \\
1 &amp; 0 &amp; \gamma(1-\gamma) \\
2 &amp; 0 &amp; \gamma^2(1-\gamma)  \\
3 &amp; 0 &amp; \gamma^3(1-\gamma) \\
4 &amp; 0 &amp; \gamma^4(1-\gamma) \\
\end{matrix}
\end{split}\]</div>
<p>¿Qué pasa si <span class="math notranslate nohighlight">\(\gamma \geq 1\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">gamma</span><span class="p">):</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">dimpulse</span><span class="p">(([</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span> 

<span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">FloatSlider_nice</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mf">1.1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">msg_throttle</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>La respuesta al impulso puede tender a infinito!</p></li>
<li><p>A diferencia de un sistema FIR el sistema IIR puede tener una configuración</p>
<ul>
<li><p>Estable: <span class="math notranslate nohighlight">\(h\)</span> tiende a cero</p></li>
<li><p>Condicionalmente estable: <span class="math notranslate nohighlight">\(h\)</span> oscila a una taza constante</p></li>
<li><p>Inestable: <span class="math notranslate nohighlight">\(h\)</span> crece/decrece infinitamente</p></li>
</ul>
</li>
</ul>
<p>Consideremos el sistema anterior y asumamos que <span class="math notranslate nohighlight">\(|\gamma|&lt;1\)</span>, desenrollando tenemos que</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
y[0] &amp;= (1-\gamma) x[0] \nonumber \\
y[1] &amp;= (1-\gamma) (x[1] + \gamma x[0]) \nonumber \\
y[2] &amp;= (1-\gamma) (x[2] + \gamma x[1] + \gamma^2 x[0]) \nonumber \\
y[3] &amp;= (1-\gamma) (x[3] + \gamma x[2] + \gamma^2 x[1] + \gamma^3 x[0]) \nonumber \\
y[4] &amp;= (1-\gamma) (x[4] + \gamma x[3] + \gamma^2 x[2] + \gamma^3 x[1]  + \gamma^4 x[0]) \nonumber \\
y[5] &amp;= \ldots \nonumber 
\end{align}
\end{split}\]</div>
<p>Con un sistema IIR de 3 coeficientes podemos representar un sistema FIR considerablemente más grande</p>
<p>Por ejemplo si escogemos <span class="math notranslate nohighlight">\(\gamma\)</span> tal que <span class="math notranslate nohighlight">\(\gamma^{20 }\approx 0\)</span> entonces aproximamos un sistema FIR de orden 20</p>
<p>Por otra parte la respuesta en frecuencia de este sistema</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
Y[k] &amp;= (1-\gamma) X[k] + \gamma Y[k] e^{-j \frac{2\pi}{N} k} \nonumber \\
H[k] = \frac{Y[k]}{X[k]} &amp;= \frac{1-\gamma}{1 - \gamma e^{-j \frac{2\pi}{N} k} } = (1-\gamma)\frac{e^{j \frac{2\pi}{N} k} - 0}{e^{j \frac{2\pi}{N} k} - \gamma  } \nonumber 
\end{align}
\end{split}\]</div>
<p>que tiene un cero en <span class="math notranslate nohighlight">\(0\)</span>, un polo en <span class="math notranslate nohighlight">\(\gamma\)</span> y ganancia <span class="math notranslate nohighlight">\(1-\gamma\)</span></p>
<p>Para entender mejor este sistema estudiemos la magnitud de <span class="math notranslate nohighlight">\(|H[k]|\)</span> para <span class="math notranslate nohighlight">\(\gamma &lt; 1\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
| H[k]| &amp;= \frac{|1-\gamma|}{|1 - \gamma e^{-j \frac{2\pi}{N} k}|}  \nonumber \\
&amp;=  \frac{1-\gamma}{\sqrt{1 - 2\gamma \cos(\frac{2\pi}{N} k) + \gamma^2}} \nonumber
\end{align}
\end{split}\]</div>
<p>¿Cómo se ve <span class="math notranslate nohighlight">\(|H[k]|\)</span>? ¿Qué función cumple este sistema?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span>
<span class="n">Hk</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">k</span> <span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">gamma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">gamma</span><span class="p">):</span>
    <span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">Hk</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">k</span><span class="p">));</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\gamma$: </span><span class="si">%0.2f</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span>
<span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">FloatSlider_nice</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span> <span class="n">msg_throttle</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Este sistema actua como filtro pasa bajo!</p></li>
</ul>
</div>
</div>
<div class="section" id="diseno-de-filtros-iir-simples">
<h2>Diseño de filtros IIR simples<a class="headerlink" href="#diseno-de-filtros-iir-simples" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Los filtros IIR más simples son los de un polo y un cero</p>
<div class="math notranslate nohighlight">
\[
H[k] = \frac{b[0] + b[1] e^{-j \frac{2\pi}{N} k}}{1 + a[1] e^{-j \frac{2\pi}{N} k}}  = K\frac{e^{j \frac{2\pi}{N} k} - \beta}{e^{j \frac{2\pi}{N} k} - \alpha  } 
\]</div>
<p>donde podemos reconocer <span class="math notranslate nohighlight">\(b[0]=K\)</span>, <span class="math notranslate nohighlight">\(\beta = - b[1]K\)</span> y <span class="math notranslate nohighlight">\(\alpha=-a[1]\)</span></p>
<ul class="simple">
<li><p>Definimos la frecuencia de corte <span class="math notranslate nohighlight">\(f_c\)</span> como aquella frecuencia en la que el filtro alcanza una atenuación de 0.7 (-3 dB)</p></li>
<li><p>En este caso <span class="math notranslate nohighlight">\(\gamma = e^{-2\pi f_c}\)</span></p></li>
</ul>
<p><strong>Receta para un filtro pasa bajo IIR con frecuencia de corte <span class="math notranslate nohighlight">\(f_c\)</span></strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(b[0] = 1 - e^{-2\pi f_c}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b[1] = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a[1] = -e^{-2\pi f_c}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
H[k] = \frac{1-e^{-2\pi f_c}}{1 - e^{-2\pi f_c} e^{-j \frac{2\pi}{N} k}} = (1-e^{-2\pi f_c}) \frac{(e^{j \frac{2\pi}{N} k}- 0)}{(e^{j \frac{2\pi}{N} k} - e^{-2\pi f_c} )}
\]</div>
<ul class="simple">
<li><p>Un cero en <span class="math notranslate nohighlight">\(0\)</span>, un polo en <span class="math notranslate nohighlight">\(e^{-2\pi f_c}\)</span> y ganancia <span class="math notranslate nohighlight">\(1-e^{-2\pi f_c}\)</span></p></li>
</ul>
<p><strong>Receta para un filtro pasa alto IIR con frecuencia de corte <span class="math notranslate nohighlight">\(f_c\)</span></strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(b[0] = (1 + e^{-2\pi f_c})/2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(b[1] = -(1 + e^{-2\pi f_c})/2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a[1] = -e^{-2\pi f_c}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
H[k] = \frac{1+e^{-2\pi f_c}}{2} \frac{(e^{j \frac{2\pi}{N} k} - 1)}{(e^{j \frac{2\pi}{N} k} - e^{-2\pi f_c})}
\]</div>
<ul class="simple">
<li><p>Un cero en <span class="math notranslate nohighlight">\(1\)</span>, un polo en <span class="math notranslate nohighlight">\(e^{-2\pi f_c}\)</span> y ganancia <span class="math notranslate nohighlight">\(\frac{1+e^{-2\pi f_c}}{2}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">fc</span><span class="p">):</span>
    <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fc</span><span class="p">)</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span><span class="p">]</span>
    <span class="c1">#gamma = np.exp(-2*np.pi*(fc))</span>
    <span class="c1">#b, a = [(1+gamma)/2, -(1+gamma)/2], [1, -gamma]</span>
    <span class="n">freq</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Espectro de</span><span class="se">\n</span><span class="s1"> magnitud&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">response</span><span class="p">)));</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Espectro de</span><span class="se">\n</span><span class="s1"> ángulo&#39;</span><span class="p">)</span>
    <span class="n">freq</span><span class="p">,</span> <span class="n">delay</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">(</span><span class="n">system</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">delay</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Retardo&quot;</span><span class="p">)</span>

<span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="n">FloatSlider_nice</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Su retardo no es igual para todas las frecuencias! ¿Qué consecuencia tiene esto?</p></li>
</ul>
<p>Aplicar un filtro a una señal:</p>
<p><code class="docutils literal notranslate"><span class="pre">scipy.signal.lfilter(b,</span> <span class="pre">a,</span> <span class="pre">x,</span> <span class="pre">axis=-1,</span> <span class="pre">zi=None)</span></code></p>
<ul class="simple">
<li><p>b (arreglo): coeficientes del numerador</p></li>
<li><p>a (arreglo): coeficientes del denominador</p></li>
<li><p>x (arreglo): señal de entrada</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">fc</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">;</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span>
<span class="c1"># b, a = [(1-gamma), 0], [1, -gamma]  # Low Pass</span>
<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="o">+</span><span class="n">gamma</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">gamma</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span><span class="p">]</span>  <span class="c1"># High pass</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">l0</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">n</span><span class="p">));</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">]);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
<span class="n">l1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">n</span><span class="p">));</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">]);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="p">),</span> <span class="n">duty</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">l0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">l1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>

<span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> 
<span class="c1">#plt.close(); HTML(anim.to_html5_video())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="diseno-de-filtros-iir-de-segundo-orden">
<h2>Diseño de filtros IIR de segundo orden<a class="headerlink" href="#diseno-de-filtros-iir-de-segundo-orden" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Los filtros IIR de segundo orden o <strong>biquad</strong> tienen dos polos y dos ceros.</p>
<p>Su respuesta en frecuencia es
$<span class="math notranslate nohighlight">\(
H[k] = \frac{b[0] + b[1] W_N^k + b[2] W_N^{2k}}{1 + a[1] W_N^k + a[2] W_N^{2k}} = K \frac{(W_N^{-k} - \beta_1) (W_N^{-k} - \beta_2)}{(W_N^{-k} - \alpha_1)(W_N^{-k} - \alpha_2)},
\)</span><span class="math notranslate nohighlight">\(
donde \)</span>W_N = e^{-j \frac{2 \pi}{N}}<span class="math notranslate nohighlight">\( y la relación entreo coeficientes y polos/ceros es: 
\)</span><span class="math notranslate nohighlight">\(
b[0] = K, \quad b[1] = -K (\beta_1 + \beta_2), \quad b[2]= K \beta_1\beta_2
\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(
a[1] = - (\alpha_1 + \alpha_2), \quad a[2]=\alpha_1 \alpha_2
\)</span>$</p>
<ul class="simple">
<li><p>Con arquitecturas de segundo orden se pueden crear filtros pasabanda y rechaza banda</p></li>
<li><p>Los filtros IIR de primer y segundo orden son menos propensos a inestabilidades</p></li>
<li><p>https://www.dsprelated.com/showarticle/1137.php</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#https://www.slideshare.net/op205/basics-of-digital-filters-presentation</span>

<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">fc1</span><span class="p">,</span> <span class="n">fc2</span><span class="p">):</span>
    <span class="n">gamma1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fc1</span><span class="p">)</span>
    <span class="c1"># gamma2 = np.exp(-2*np.pi*fc2)</span>
    <span class="c1"># b, a = [(1-gamma), 0], [1, -gamma]</span>
    <span class="c1">#b, a = [(1+gamma)/2, -(1+gamma)/2], [1, -gamma]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fc1</span><span class="p">),</span> <span class="mf">0.9</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fc1</span><span class="p">)]</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">freq</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz_zpk</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Espectro de</span><span class="se">\n</span><span class="s1"> magnitud&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">response</span><span class="p">)));</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Espectro de</span><span class="se">\n</span><span class="s1"> ángulo&#39;</span><span class="p">)</span>
    <span class="c1">#freq, delay = scipy.signal.group_delay(system=(b, a))</span>
    <span class="c1">#ax[2].cla(); ax[2].plot(0.5*freq/np.pi, delay); ax[2].set_ylabel(&quot;Retardo&quot;)</span>

<span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">fc1</span><span class="o">=</span><span class="n">FloatSlider_nice</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.25</span><span class="p">),</span>
         <span class="n">fc2</span><span class="o">=</span><span class="n">FloatSlider_nice</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.3</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="diseno-de-filtros-iir-de-orden-mayor">
<h2>Diseño de filtros IIR de orden mayor<a class="headerlink" href="#diseno-de-filtros-iir-de-orden-mayor" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Crear coeficientes de filtro IIR de orden mayor</p>
<p><code class="docutils literal notranslate"><span class="pre">scipy.signal.iirfilter(N,</span> <span class="pre">Wn,</span> <span class="pre">rp=None,</span> <span class="pre">rs=None,</span> <span class="pre">btype='bandpass',</span> <span class="pre">analog=False,</span> <span class="pre">ftype='butter',</span> <span class="pre">output='ba')</span></code></p>
<ul class="simple">
<li><p>N (entero): orden del filtro</p></li>
<li><p>Wn (arreglo): Frecuencias de corte (normalizadas en [0, 1])</p></li>
<li><p>btype (string): Tipo de filtro {“bandpass”, “lowpass”, “highpass”, “bandstop”}</p></li>
<li><p>ftype (string): Tipo de filtro {“butter”, “ellip”, “cheby1”, “cheby2”, “bessel”}</p></li>
<li><p>output (string): Tipo de retorno</p></li>
</ul>
<p>El filtro Butterworth (“butter”) es óptimo en el sentido de tener la banda de paso lo más plana posible. Otros filtros se diseñaron con otras consideraciones. Los filtros IIR digitales están basados en los filtros IIR analógicos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">ftype</span><span class="p">):</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">iirfilter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="n">ftype</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
    <span class="n">freq</span><span class="p">,</span> <span class="n">response</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">response</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Espectro</span><span class="se">\n</span><span class="s1">de magnitud&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">response</span><span class="p">)));</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Espectro</span><span class="se">\n</span><span class="s1">de ángulo&#39;</span><span class="p">)</span>
    <span class="n">freq</span><span class="p">,</span> <span class="n">delay</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">(</span><span class="n">system</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">cla</span><span class="p">();</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">delay</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Retardo&quot;</span><span class="p">)</span>
    
<span class="n">interact</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">SelectionSlider_nice</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
         <span class="n">ftype</span><span class="o">=</span><span class="n">SelectionSlider_nice</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="s1">&#39;bessel&#39;</span><span class="p">]));</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">iirfilter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">l0</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">n</span><span class="p">));</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">]);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Input&#39;</span><span class="p">)</span>
<span class="n">l1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">n</span><span class="p">));</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Output&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">square</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="p">),</span> <span class="n">duty</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">l0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="c1">#y = scipy.signal.filtfilt(b, a, x)</span>
    <span class="n">l1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>

<span class="n">anim</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">update</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> 
<span class="c1">#plt.close(); HTML(anim.to_html5_video())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="respuesta-en-frecuencia-de-filtros-fir-e-iir-del-orden-equivalente">
<h2>Respuesta en frecuencia de filtros FIR e IIR del orden equivalente<a class="headerlink" href="#respuesta-en-frecuencia-de-filtros-fir-e-iir-del-orden-equivalente" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">iirfilter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">freq_fir</span><span class="p">,</span> <span class="n">response_fir</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">freq_iir</span><span class="p">,</span> <span class="n">response_iir</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Espectro</span><span class="se">\n</span><span class="s1">de magnitud&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Retardo&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_fir</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">response_fir</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_iir</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">response_iir</span><span class="p">));</span> 
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;FIR&#39;</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;IIR&#39;</span><span class="p">);</span> 
<span class="n">freq_fir</span><span class="p">,</span> <span class="n">delay_fir</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">(</span><span class="n">system</span><span class="o">=</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_fir</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">delay_fir</span><span class="p">);</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">delay_fir</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">delay_fir</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="n">freq_iir</span><span class="p">,</span> <span class="n">delay_iir</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">group_delay</span><span class="p">(</span><span class="n">system</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_iir</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">delay_iir</span><span class="p">);</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="efectos-de-audio-a-href-https-en-wikipedia-org-wiki-wah-wah-music-wah-wah-a">
<h2>Efectos de audio: <a href="https://en.wikipedia.org/wiki/Wah-wah_(music)">Wah-wah</a><a class="headerlink" href="#efectos-de-audio-a-href-https-en-wikipedia-org-wiki-wah-wah-music-wah-wah-a" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li><p>Filtro pasabanda modulado</p></li>
<li><p>Ancho de pasada fijo <span class="math notranslate nohighlight">\(f_b\)</span> [Hz]</p></li>
<li><p>Frecuencia central variable <span class="math notranslate nohighlight">\(f_c\)</span> [Hz]</p></li>
<li><p>La frecuencia central se modula con una onda lenta</p></li>
<li><p>Se modela como el siguiente sistema <strong>IIR</strong>
$<span class="math notranslate nohighlight">\(
H[k] = \frac{(1+c)W_N^{2k} -(1+c) }{W_N^{2k} + d(1-c)W_N^k -c}
\)</span><span class="math notranslate nohighlight">\(
donde \)</span>d=-\cos(2\pi f_c/f_s)<span class="math notranslate nohighlight">\( y \)</span>c = \frac{\tan(\pi f_b/f_s) -1}{\tan(2\pi f_b /f_s)+1}$</p></li>
</ul>
<p>Ref: https://www.ee.columbia.edu/~ronw/adst-spring2010/lectures/lecture2.pdf</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">fs</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;data/nomekop.ogg&quot;</span><span class="p">)</span>
<span class="n">Audio</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fs</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fb</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">Nw</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">5</span>
<span class="n">c</span>  <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fb</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fb</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data_wah</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">zi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">Nw</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">+</span> <span class="mi">2000</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="mf">30.</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">fc</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">data2</span><span class="p">,</span> <span class="n">zi</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">([(</span><span class="mi">1</span><span class="o">+</span><span class="n">c</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">c</span><span class="p">)],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">c</span><span class="p">),</span> <span class="o">-</span><span class="n">c</span><span class="p">],</span> 
                                     <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="o">*</span><span class="n">Nw</span><span class="p">:(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Nw</span><span class="p">],</span> <span class="n">zi</span><span class="o">=</span><span class="n">zi</span><span class="p">)</span>
    <span class="n">data_wah</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<span class="n">Audio</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">data_wah</span><span class="p">),</span> <span class="n">rate</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">fs</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Design of recursive filters
http://www-pagines.fib.upc.es/~pds/Lect06.pdf</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./clases/unidad2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Pablo Huijse Heise<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.30270b6e4c972e43c488.js"></script>


    
  </body>
</html>