Traceback (most recent call last):
  File "/home/phuijse/.conda/envs/info183/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/home/phuijse/.conda/envs/info183/lib/python3.8/site-packages/nbclient/client.py", line 1082, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/phuijse/.conda/envs/info183/lib/python3.8/site-packages/nbclient/util.py", line 74, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/phuijse/.conda/envs/info183/lib/python3.8/site-packages/nbclient/util.py", line 53, in just_run
    return loop.run_until_complete(coro)
  File "/home/phuijse/.conda/envs/info183/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/home/phuijse/.conda/envs/info183/lib/python3.8/site-packages/nbclient/client.py", line 535, in async_execute
    await self.async_execute_cell(
  File "/home/phuijse/.conda/envs/info183/lib/python3.8/site-packages/nbclient/client.py", line 827, in async_execute_cell
    self._check_raise_for_error(cell, exec_reply)
  File "/home/phuijse/.conda/envs/info183/lib/python3.8/site-packages/nbclient/client.py", line 735, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply['content'])
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
plt.close('all'); fig, ax = plt.subplots(5, 2, figsize=(8, 9))
n = np.arange(0, 100, step=1); 
f = fftpack.fftshift(fftpack.fftfreq(n=len(n), d=1))
np.random.seed(0); C = 5*np.exp(-0.5*(n[:, np.newaxis] - n[:, np.newaxis].T)**2/10**2)
x_clean = np.random.multivariate_normal(np.zeros_like(n), C)
x_clean -= np.mean(x_clean)
x = x_clean + 2*np.random.randn(len(n))
def update(fc, L, window='rect'):
    [axx.cla() for axx in ax.ravel()]
    # Se√±al limpia
    ax[0, 0].plot(n, x_clean); 
    ax[0, 1].plot(f, fftpack.fftshift(np.absolute(fftpack.fft(x_clean))))
    ax[0, 0].set_title("Tiempo"); ax[0, 1].set_title("Frecuencia")    
    # Se√±al contaminada
    ax[1, 0].plot(n, x); ylims = ax[1, 0].get_ylim(); ax[0, 0].set_ylim(ylims)
    X = fftpack.fft(x); 
    ax[1, 1].plot(f, fftpack.fftshift(np.absolute(X)))
    # Filtro ideal
    kc = int(len(n)*fc)
    Hd = np.zeros_like(n, dtype=np.float); Hd[:kc] = 1.; Hd[len(Hd)-kc+1:] = 1.
    ax[2, 1].plot(f, fftpack.fftshift(Hd))
    hd = np.real(fftpack.ifftshift(fftpack.ifft(Hd)))
    ax[2, 0].plot(n, hd)
    # Filtro real
    w = np.zeros_like(n, dtype=np.float); 
    if window == 'rect':
        w[len(w)//2-L//2:len(w)//2+L//2+1] = 1.;
    elif window == 'hann':
        w[len(w)//2-L//2:len(w)//2+L//2+1] = scipy.signal.hann(L+1)
    h = w*hd; H = fftpack.fft(h); 
    print("NMSE entre H y Hd %0.4f" % (np.mean((np.absolute(H) - Hd)**2)/np.mean(Hd**2)))
    ax[3, 0].plot(n, h);  ylims2 = ax[3, 0].get_ylim(); 
    ax[3, 0].plot(n, w, '--'); ax[3, 0].set_ylim(ylims2)
    ax[3, 1].plot(f, fftpack.fftshift(np.absolute(H)))
    # Se√±al filtrada
    xf = scipy.signal.convolve(x, h, mode='same')
    ax[4, 0].plot(n, np.real(xf)); 
    ax[4, 1].plot(f, fftpack.fftshift(np.absolute(fftpack.fft(xf)))); ax[4, 0].set_ylim(ylims)
    
interact(update, fc=FloatSlider_nice(min=0.01, max=0.5, step=0.01, value=0.1),
         L=SelectionSlider_nice(options=[4, 6, 10, 20, 40, 60, 80], value=60),
         window=SelectionSlider_nice(options=['rect', 'hann']));
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mNameError[0m                                 Traceback (most recent call last)
[0;32m<ipython-input-3-c86c749cc829>[0m in [0;36m<module>[0;34m[0m
[1;32m      1[0m [0mplt[0m[0;34m.[0m[0mclose[0m[0;34m([0m[0;34m'all'[0m[0;34m)[0m[0;34m;[0m [0mfig[0m[0;34m,[0m [0max[0m [0;34m=[0m [0mplt[0m[0;34m.[0m[0msubplots[0m[0;34m([0m[0;36m5[0m[0;34m,[0m [0;36m2[0m[0;34m,[0m [0mfigsize[0m[0;34m=[0m[0;34m([0m[0;36m8[0m[0;34m,[0m [0;36m9[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m      2[0m [0mn[0m [0;34m=[0m [0mnp[0m[0;34m.[0m[0marange[0m[0;34m([0m[0;36m0[0m[0;34m,[0m [0;36m100[0m[0;34m,[0m [0mstep[0m[0;34m=[0m[0;36m1[0m[0;34m)[0m[0;34m;[0m[0;34m[0m[0;34m[0m[0m
[0;32m----> 3[0;31m [0mf[0m [0;34m=[0m [0mfftpack[0m[0;34m.[0m[0mfftshift[0m[0;34m([0m[0mfftpack[0m[0;34m.[0m[0mfftfreq[0m[0;34m([0m[0mn[0m[0;34m=[0m[0mlen[0m[0;34m([0m[0mn[0m[0;34m)[0m[0;34m,[0m [0md[0m[0;34m=[0m[0;36m1[0m[0;34m)[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m      4[0m [0mnp[0m[0;34m.[0m[0mrandom[0m[0;34m.[0m[0mseed[0m[0;34m([0m[0;36m0[0m[0;34m)[0m[0;34m;[0m [0mC[0m [0;34m=[0m [0;36m5[0m[0;34m*[0m[0mnp[0m[0;34m.[0m[0mexp[0m[0;34m([0m[0;34m-[0m[0;36m0.5[0m[0;34m*[0m[0;34m([0m[0mn[0m[0;34m[[0m[0;34m:[0m[0;34m,[0m [0mnp[0m[0;34m.[0m[0mnewaxis[0m[0;34m][0m [0;34m-[0m [0mn[0m[0;34m[[0m[0;34m:[0m[0;34m,[0m [0mnp[0m[0;34m.[0m[0mnewaxis[0m[0;34m][0m[0;34m.[0m[0mT[0m[0;34m)[0m[0;34m**[0m[0;36m2[0m[0;34m/[0m[0;36m10[0m[0;34m**[0m[0;36m2[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m      5[0m [0mx_clean[0m [0;34m=[0m [0mnp[0m[0;34m.[0m[0mrandom[0m[0;34m.[0m[0mmultivariate_normal[0m[0;34m([0m[0mnp[0m[0;34m.[0m[0mzeros_like[0m[0;34m([0m[0mn[0m[0;34m)[0m[0;34m,[0m [0mC[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;31mNameError[0m: name 'fftpack' is not defined
NameError: name 'fftpack' is not defined

